trigger:
  branches:
    include:
      - master  # Branch que irei configurar como trigger na pipeline

jobs:
  - job: build
    displayName: 'Build and Push Docker Image to Docker Hub'
    pool:
      name: 'Ryzen-Neto-Local'  # Agente local que vai rodar o pipeline
    steps:
      - script: |
          # Invocar WSL para executar todos os comandos
          wsl bash -c "
          # Certificar-se de que estamos no diret칩rio correto
          cd \$(wslpath '$(Build.SourcesDirectory)')

          # Login no Docker Hub
          echo \$DOCKER_PASSWORD | docker login -u \$DOCKER_USERNAME --password-stdin

          # Build e Push da imagem usando buildx
          docker buildx build --platform linux/amd64 -f Dockerfile -t jpneto90/unyleya_projeto_devops:latest --push .
          "
        displayName: 'Build and Push Docker Image'
        env:
          DOCKER_USERNAME: $(DOCKER_USERNAME)  # Vari치vel de ambiente com o usu치rio do Docker Hub
          DOCKER_PASSWORD: $(DOCKER_PASSWORD)  # Vari치vel de ambiente com a senha do Docker Hub
