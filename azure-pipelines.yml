trigger:
  branches:
    include:
      - master  # branch que irei configurar como trigger na pipeline
jobs:
  - job: build
    displayName: 'Build Docker Image on WSL'
    pool:
      name: 'Ryzen-Neto-Local'  # VM que vai rodar o pipeline
    steps:
      - script: |
          # Login no Docker Hub
          echo $DOCKER_PASSWORD | docker login -u $DOCKER_USERNAME --password-stdin
          
          # Construir a imagem Docker diretamente no WSL
          docker build -f **/Dockerfile -t jpneto90/unyleya_projeto_devops:latest .
          
          # Empurrar a imagem para o Docker Hub
          docker push jpneto90/unyleya_projeto_devops:latest
        displayName: 'Build and Push Docker Image'
        env:
          DOCKER_USERNAME: $(DOCKER_USERNAME)
          DOCKER_PASSWORD: $(DOCKER_PASSWORD)
